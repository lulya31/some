@startuml C1

!include static/includes/c4_context.puml
!include static/includes/c4_container.puml
!include static/includes/c4_component.puml

skinparam backgroundcolor transparent
skinparam minClassWidth 200
'skinparam linetype polyline
skinparam linetype ortho

LAYOUT_LEFT_RIGHT()

System_Boundary(ext_systems1, "Внешние системы") {
    System_Ext(elt, "ELT", "", $sprite="img:./static/06_img/elt_logo.png{scale=0.75}")
    System_Ext(dadata, "", "", $sprite="img:./static/06_img/dadata_logo.png{scale=0.2}")
    System_Ext(tinkoff, "Tinkoff", "", $sprite="img:./static/06_img/tinkoff_logo.png{scale=0.25}")
    System_Ext(autoteka_ru, "Autoteka.ru", "", $sprite="img:./static/06_img/autoteka_ru.png{scale=0.4}")
    System_Ext(rosbank, "Rosbank", "", $sprite="img:./static/06_img/rosbank.png{scale=0.15}")
}

System_Boundary(ext_systems2, "Внешние системы") {    
    System_Ext(e_credit, "Е-кредит", "", $sprite="img:./static/06_img/e_credit.png{scale=0.25}")
    System_Ext(auto_ru, "Auto.ru", "", $sprite="img:./static/06_img/auto_ru.png{scale=0.2}")
    System_Ext(kia_myservice, "KIA MyService", "", $sprite="img:./static/06_img/kia_myservice.png{scale=0.075}")
    System_Ext(focus_kontur, "Контур Фокус", "", $sprite="img:./static/06_img/focus_kontur.png{scale=0.25}")
    System_Ext(sber, "Сбер", "", $sprite="img:./static/06_img/sber.png{scale=0.1}")
}

System_Boundary(rolf, "Рольф") {
    Person(user, "USER", "Пользователь")
    Person(admin, "ADMIN", "Администратор")

    System(flora, "FLORA", "FLORA", $link="/06_c4_infrastructure/01_flora/")

    System_Boundary(payments_acquiring, "Платежный эквайринг") {
        System(atol, "Atol", "Atol")
        System(kkm, "ККМ", "", $sprite="img:./static/06_img/kkm.png{scale=0.25}")
        System(payment_gate, "Платежный шлюз", "", $sprite="img:./static/06_img/payment_gate.png{scale=0.25}")
        System(1c_rose, "1C Rose", "", $sprite="img:./static/06_img/1c_arms.png{scale=0.05}")
    }

    System(erl, "ERL", "Единый рабочий лист")
    System(smtp, "SMTP Server", "", $sprite="img:./static/06_img/smtp.png{scale=0.25}")
    System(sms_gate, "SMS Шлюз", "", $sprite="img:./static/06_img/sms_gate.png{scale=0.5}")
    System(ad, "Active Directory", "", $sprite="img:./static/06_img/ad.png{scale=0.4}")
    System(1c_arms, "1С АРМС", "", $sprite="img:./static/06_img/1c_arms.png{scale=0.05}")
    System(saphr, "", "", $sprite="img:./static/06_img/sap_hr_logo.png{scale=0.1}")
    System(wms, "", "", $sprite="img:./static/06_img/wms_logo.png{scale=0.5}")
    System(mdm, "MDM", "", $sprite="img:./static/06_img/mdm.png{scale=0.015}")

    System_Boundary(opersystems, "Оперсистемы") {
        System(fishblue, "FishBlue", "", $sprite="img:./static/06_img/fishblue.png{scale=0.05}")
        System(is_storm, "ИС Шторм", "", $sprite="img:./static/06_img/is_storm.png{scale=0.25}")
        System(as_rolf, "АС Рольф", "", $sprite="img:./static/06_img/as_rolf.png{scale=0.25}")
        System(as_rolf_insurance, "АС Рольф Страхование", "", $sprite="img:./static/06_img/as_rolf_insurance.png{scale=0.25}")
    }

    Rel(user, flora, "")
    Rel(admin, flora, "")

    BiRel_D(flora, atol, "")
    BiRel_D(flora, kkm, "")
    BiRel_D(flora, payment_gate, "")
    BiRel_D(flora, 1c_rose, "")

    BiRel_D(flora, erl, "")
    BiRel_D(flora, smtp, "")
    BiRel_D(flora, sms_gate, "")
    BiRel_D(flora, ad, "")

    BiRel_U(flora, 1c_arms, "")
    BiRel_U(flora, saphr, "")
    BiRel_U(flora, wms, "")
    BiRel_U(flora, mdm, "")
    BiRel_U(flora, fishblue, "")
    BiRel_U(flora, is_storm, "")
    BiRel_U(flora, as_rolf, "")
    BiRel_U(flora, as_rolf_insurance, "")
    
}

BiRel_D(flora, elt, "")
BiRel_R(flora, dadata, "")
BiRel_R(flora, tinkoff, "")
BiRel_R(flora, autoteka_ru, "")
BiRel_R(flora, rosbank, "")

BiRel_U(flora, e_credit, "")
BiRel_L(flora, auto_ru, "")
BiRel_L(flora, kia_myservice, "")
BiRel_L(flora, focus_kontur, "")
BiRel_L(flora, sber, "")

@enduml